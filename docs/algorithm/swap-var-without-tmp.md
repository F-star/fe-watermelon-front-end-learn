# 不使用临时变量，交换两个数

大家好，我是前端西瓜哥，今天我们看一道很经典的面试题。

假设我们有两个数 a 和 b，交换它们的值。这里不允许使用临时变量。

## 解法 1：使用两数之差

如果 b 直接设置为 a 之后，就会导致 a 拿不到 b 的值，因为这时候 b 的值和 a 相同。

怎么办？利用两数之差。

```
           diff
|--------|-------|
         b       a
```

我们先通过 `a = a - b ` 拿到 b 达到 a 需要加的差值。

此时 a 其实应该叫 diff 了，但我们不能使用临时变量，所以只能还是叫 a。但为以示和原来的 a 的区别，且写作 a，读作 diff，即 a(diff)。

然后 `b = b + a(diff)`。b 加上了这个差值，值就变成了 a。

最后是 `a = b - a(diff)`，又通过 b 演算出 a。自此，交换结束。

完整代码实现为：

```js
let a = 1;
let b = 2;

a = a - b;
b = b + a;
a = b - a;
```

缺点是有溢出的可能，导致拿到匪夷所思的值。

## 解法2：位操作——按位异或

按位异或 `^`，就是将两个数的每一位进行比较，**相同的得到 0，不同的得到 1**。

```js
1 ^ 0 = 1
0 ^ 1 = 1
0 ^ 0 = 0
1 ^ 1 = 1
```

异或运算几个很有用的特性：

- **归零律：一个数和自己进行异或运算，得到的是 0**：`x^x = 0`。因为所有的对应位都是相同的，所以只能得到 0。
- **恒等律：一个数和 0 进行异或运算，得到的还是这个数**。`x^0 = x`。因为对于 0 来说，如果对方是 1，得到的是 1；如果对方是 0，得到的是 0。所以整了半天，结果还是原来的那个数。
- **交换律和结合律**。

我们先看代码实现：

```js
let a = 1;
let b = 2;

a = a^b;
b = a^b;
a = a^b;
```

每一步的值的变化如下：

![image-20220312220907535.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28342df9d914437598c598d6bc3f5a09~tplv-k3u1fbpfcp-watermark.image?)

这里的推演用到了上面说的四个定律。

位运算用来解题，理解和实现上会有点折磨，因为我们并不是生活在二进制的世界里，脑子容易转不过来。

优点是不会造成溢出的问题，而且可以使用的数据类型更多。不过对 js 来说，位运算只能用在数字类型上。

## 结尾

不使用临时变量，交换两个数的方式有两种。

一种是将其中一个变量转换为两数之差，以此为跳板进行值的交换，但有值溢出的风险。

另一种则是利用了按位异或的特性，是更好的解法。这种实现没有溢出风险，并能使用在更多的类型上，比如指针。

不使用临时变量的交换方式，并没有带来性能上的提升，在实际工作中请不要用这些面试才会有的奇葩写法。

我是啥都写的前端西瓜哥，欢迎关注我。




